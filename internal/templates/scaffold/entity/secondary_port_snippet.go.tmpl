
// {{.Name}}Repository defines the secondary port for {{.NameLower}} persistence.
type {{.Name}}Repository interface {
	// Create persists a new {{.NameLower}}.
	Create(ctx context.Context, {{.NameLower}} *{{.Name}}Record) error

	// GetByID retrieves a {{.NameLower}} by its ID.
	GetByID(ctx context.Context, id string) (*{{.Name}}Record, error)

	// List retrieves {{.NamePlural}} matching the given filters.
	List(ctx context.Context, filters {{.Name}}Filters) ([]*{{.Name}}Record, error)

	// Update updates an existing {{.NameLower}}.
	Update(ctx context.Context, {{.NameLower}} *{{.Name}}Record) error

	// Delete removes a {{.NameLower}} from persistence.
	Delete(ctx context.Context, id string) error

	// Pin pins a {{.NameLower}}.
	Pin(ctx context.Context, id string) error

	// Unpin unpins a {{.NameLower}}.
	Unpin(ctx context.Context, id string) error

	// GetNextID returns the next available {{.NameLower}} ID.
	GetNextID(ctx context.Context) (string, error)
{{- if .HasParent}}

	// {{.ParentEntity}}Exists checks if a {{.ParentEntityLower}} exists.
	{{.ParentEntity}}Exists(ctx context.Context, {{.ParentEntityLower}}ID string) (bool, error)
{{- if eq .ParentCardinality "1:1"}}

	// {{.ParentEntity}}Has{{.Name}} checks if a {{.ParentEntityLower}} already has a {{.NameLower}} (for 1:1 relationships).
	{{.ParentEntity}}Has{{.Name}}(ctx context.Context, {{.ParentEntityLower}}ID string) (bool, error)
{{- end}}
{{- end}}
}

// {{.Name}}Record represents a {{.NameLower}} as stored in persistence.
type {{.Name}}Record struct {
	ID string
{{- if .HasParent}}
	{{.ParentEntity}}ID string
{{- end}}
{{- range .Fields}}
	{{.Name}} {{if eq .Type "time.Time"}}string{{else}}{{.Type}}{{end}}
{{- end}}
{{- if .HasStatus}}
	Status string
{{- end}}
	Pinned    bool
	CreatedAt string
	UpdatedAt string
}

// {{.Name}}Filters contains filter options for querying {{.NamePlural}}.
type {{.Name}}Filters struct {
{{- if .HasParent}}
	{{.ParentEntity}}ID string
{{- end}}
{{- if .HasStatus}}
	Status string
{{- end}}
}

